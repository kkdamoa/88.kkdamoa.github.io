<!-- 오버레이 및 팝업 콘텐츠 -->
<div id="overlay" onclick="closePopup()" style="display: none;"></div>
<div id="popup" style="display: none;">
    <h2>kkdamoa에 오신 것을 환영합니다</h2>
    <p>더 많은 콘텐츠를 보려면 광고를 시청하세요. 5초 후 광고 시청 후 추천 페이지로 이동합니다. 원치 않으시면 닫기 버튼을 클릭해주세요.</p>
    <p id="popupCounter">5초 후 광고 시청이 시작됩니다...</p>
    <button onclick="closePopup()">닫기</button>
</div>

<div id="adContainer" style="display: none;">
    <div class="ad-header">
        <span id="adCounter">광고가 5초 후에 닫힐 수 있습니다...</span>
        <button class="close-btn" onclick="closeAd()">&times;</button>
    </div>
    <h2>광고</h2>
    <div style="text-align:center; margin-bottom:10px;">
        <button onclick="closeAd()" style="border:none; background:none; font-size:20px; cursor:pointer;">&times;</button>
    </div>
    <ins class="adsbygoogle"
         style="display:block; margin: auto;"
         data-ad-client="ca-pub-9374368296307755"
         data-ad-slot="9952845435"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
</div>

<script>
    window.onload = function() {
        // 5초에서 10초 사이의 랜덤 딜레이 설정
        let randomDelay = Math.floor(Math.random() * (10000 - 5000 + 1)) + 5000;
        setTimeout(showPopup, randomDelay);
    };

    function showPopup() {
        document.getElementById('overlay').style.display = 'block';
        document.getElementById('popup').style.display = 'block';
        document.body.style.overflow = 'hidden'; // 스크롤 비활성화

        let counter = 5;
        let popupCounter = document.getElementById('popupCounter');
        let countdown = setInterval(function() {
            counter--;
            popupCounter.textContent = `${counter}초 후 광고 시청이 시작됩니다...`;
            if (counter <= 0) {
                clearInterval(countdown);
                popupCounter.textContent = "광고를 시작할 준비가 되었습니다.";
                showAd(); // 카운터 후 광고를 자동으로 표시
            }
        }, 1000);
    }

    function closePopup() {
        document.getElementById('overlay').style.display = 'none';
        document.getElementById('popup').style.display = 'none';
        document.body.style.overflow = ''; // 스크롤 활성화
    }

    function showAd() {
        document.getElementById('popup').style.display = 'none'; // 팝업을 닫음
        document.getElementById('adContainer').style.display = 'block'; // 광고 컨테이너 표시
        document.body.style.overflow = 'hidden'; // 스크롤 비활성화

        (adsbygoogle = window.adsbygoogle || []).push({});

        let adCounter = document.getElementById('adCounter');
        let closeButton = document.querySelector('.close-btn');
        closeButton.style.display = 'inline';

        // 5초 광고 닫기 카운터
        let counter = 5;
        let countdown = setInterval(function() {
            counter--;
            adCounter.textContent = `광고가 ${counter}초 후에 닫힐 수 있습니다...`;
            if (counter <= 0) {
                clearInterval(countdown);
                adCounter.textContent = "광고를 닫을 수 있습니다.";
                closeButton.style.display = 'inline';
            }
        }, 1000);
    }

    function closeAd() {
        document.getElementById('adContainer').style.display = 'none';
        document.body.style.overflow = '';
        alert('광고 시청이 완료되었습니다.');
    }
</script>
